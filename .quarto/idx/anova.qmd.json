{"title":"Anova","markdown":{"yaml":{"title":"Anova"},"headingText":"Interpretação do P-valor na ANOVA","containsRefs":false,"markdown":"\n\nQuando você precisa comparar as médias de três ou mais grupos, a Análise de Variância (ANOVA) é a ferramenta estatística ideal. Para que a ANOVA seja aplicada corretamente, seus dados precisam atender aos seguintes critérios:\n\n-   As amostras devem seguir uma distribuição paramétrica (geralmente normal).\n\n-   As amostras devem ser aleatórias e independentes (os dados de um grupo não devem influenciar os outros).\n\n-   As populações de onde as amostras foram retiradas devem ter variâncias semelhantes.\n\nDentro da ANOVA, os tipos mais comuns são a de um fator e a de dois fatores, dependendo de quantas variáveis você está investigando ao mesmo tempo.\n\n-   **ANOVA de um Fator**: É usada quando você compara grupos com base em apenas uma característica.\n\n    Exemplo: Suponha que um pesquisador queira comparar a mortalidade de uma praga (ex: mosca-branca) após a aplicação de três diferentes tipos de inseticidas (Inseticida A, Inseticida B e Inseticida C). A ANOVA de um fator ajudaria a determinar se há uma diferença significativa na mortalidade da praga entre os inseticidas testados.\n\n-   **ANOVA de Dois Fatores**: É usada quando você compara grupos com base em duas características ao mesmo tempo.\n\n    Exemplo: Imagine que você quer analisar o número de ovos depositados por uma lagarta em diferentes cultivares de soja (Cultivar 1, Cultivar 2) e também considerar a temperatura ambiente (25°C, 30°C). A ANOVA de dois fatores permitiria analisar o efeito combinado da cultivar e da temperatura no número de ovos depositados pela lagarta.\n\n\nNa ANOVA, se o **P-valor for igual ou menor que 0,05** (um nível de significância comum de α=0,05), você rejeita a hipótese nula (que todas as médias populacionais são iguais) e conclui que pelo menos uma das médias é diferente das outras. Isso significa que há uma diferença estatisticamente significativa entre os grupos que você está comparando.\n\nSe o **P-valor for maior que 0,05**, você aceita a hipótese nula, o que indica que não há evidências suficientes para dizer que as médias populacionais são diferentes. Nesse caso, a diferença observada entre as médias dos seus grupos é provavelmente devido ao acaso.\n\nPacotes que ainda não foram usados neste site e precisam ser instalados\n\n```{r, echo=TRUE, eval=FALSE}\ninstall.packages(\"emmeans\")\ninstall.packages(\"multcomp\")\n\n```\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(gsheet)\nlibrary(ggplot2)\n\nmicelial <- gsheet2tbl (\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\n# Visualizando os dados com um gráfico de boxplot\nmicelial |> \n  ggplot(aes(especie, tcm)) +\n  geom_boxplot(outlier.colour = NA) + # Removendo os outliers do boxplot\n  geom_jitter() # Adicionando pontos para visualização\n```\n\n#### Realizando a ANOVA com um fator\n\nAgora, vamos realizar a ANOVA para testar se existe uma diferença significativa entre as médias de tcm para diferentes especies.\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(rstatix)\nanova1 <- aov(tcm ~ especie, data = micelial)\nanova1\n\n```\n\nAlternativamente, podemos realizar a ANOVA utilizando a função **`lm()`**, que também realiza uma análise de regressão linear. O resultado será o mesmo.\n\n```{r, message=FALSE, warning=FALSE}\n# ANOVA utilizando a regressão linear\nanova2 <- lm(tcm ~ especie, data = micelial)\nanova2\n\n# Comparando os resultados da ANOVA\nanova(anova1)\nanova(anova2)\n\n```\n\nA função **`anova()`** mostra a tabela de ANOVA com os valores de F e p, que nos ajudam a verificar se a diferença entre as médias é significativa.\n\n#### Verificando os Resíduos\n\nAntes de interpretar os resultados da ANOVA, precisamos verificar se os pressupostos de normalidade e homogeneidade das variâncias são atendidos. Para isso, vamos analisar os resíduos da ANOVA.\n\n```{r, message=FALSE, warning=FALSE}\n# Obtendo os resíduos da ANOVA\nresiduals(anova1) \n\n# Visualizando os resíduos em um histograma\nhist(residuals(anova1))\n\n# Realizando o teste de normalidade de Shapiro-Wilk nos resíduos\nshapiro.test(residuals(anova1))\n\n```\n\nQuando o valor de p for maior que 0,05 no teste de Shapiro-Wilk, podemos concluir que os resíduos são normalmente distribuídos.\n\n#### Testando a Homogeneidade das Variâncias\n\nA ANOVA pressupõe que as variâncias dos grupos sejam homogêneas. Podemos testar isso de duas maneiras: utilizando o **Teste de Bartlett** ou o **Teste de Levene**.\n\n```{r, message=FALSE, warning=FALSE}\n# Teste de Bartlett para homogeneidade de variâncias\nbartlett.test(tcm ~ especie, data = micelial)\n\n# Teste de Levene para homogeneidade de variâncias\nlevene_test(tcm ~ especie, data = micelial)\n\n```\n\nAmbos os testes verificam se as variâncias dos grupos são iguais. Se o valor p for maior que 0,05, as variâncias podem ser consideradas homogêneas.\n\n*O **Teste de Bartlett** verifica a homogeneidade das variâncias e é mais eficaz quando os dados seguem uma distribuição normal. Ele tem maior poder para identificar diferenças nas variâncias quando a normalidade é atendida.*\n\n*\\\nO **Teste de Levene** também testa a homogeneidade das variâncias, mas é mais confiável em casos de desvios da normalidade. Ele é ideal para quando os dados não seguem uma distribuição normal perfeita.*\n\n### Realizando Contrastes e Estimativas de Médias\n\nApós a ANOVA, podemos realizar contrastes para comparar as médias entre os grupos utilizando o pacote `emmeans`.\n\n```{r, message=FALSE, warning=FALSE}\n# Carregando o pacote 'emmeans' para contrastes\nlibrary(emmeans)\n\n# Realizando os contrastes das médias\nm <- emmeans(anova2, ~ especie)\nm\n\n```\n\nO pacote **emmeans()** permite que você calcule médias ajustadas para as variáveis de interesse, com base no modelo estimado. O pacote também permite que você faça comparações entre médias ajustadas usando contrastes, que podem incluir comparações múltiplas ou post-hoc (para analisar mais detalhadamente onde estão as diferenças entre os grupos). Ele também calcula intervalos de confiança para as médias ajustadas, permitindo uma compreensão mais detalhada da variabilidade dos dados.\n\n#### Comparações Múltiplas (Post-Hoc)\n\nSe a ANOVA indicar que existem diferenças significativas, podemos realizar comparações múltiplas para identificar quais grupos são diferentes entre si. O pacote **`multcomp`** é utilizado para essas comparações.\n\n```{r, message=FALSE, warning=FALSE}\n# Carregando o pacote 'multcomp'\nlibrary(multcomp)\n\n# Realizando comparações múltiplas\ncld(m)  # Mostra as letras compactas (grupos que são semelhantes)\n\n# Realizando comparações pareadas\npairs(m)\n\n# Fazendo uma matriz de resultados\npwpm(m)\n\n```\n\nO pacote **`multcomp`** é utilizado para realizar **comparações múltiplas** (post-hoc) após modelos lineares ou ANOVA. Ele ajuda a comparar as médias de diferentes grupos, ajustando para múltiplas comparações e controlando o erro tipo I.\n\nA função `cld()` exibe as letras compactas, que indicam quais grupos são significativamente diferentes. As comparações pareadas são feitas com a função `pairs()`, e a função `pwpm()` gera uma matriz de resultados.\n","srcMarkdownNoYaml":"\n\nQuando você precisa comparar as médias de três ou mais grupos, a Análise de Variância (ANOVA) é a ferramenta estatística ideal. Para que a ANOVA seja aplicada corretamente, seus dados precisam atender aos seguintes critérios:\n\n-   As amostras devem seguir uma distribuição paramétrica (geralmente normal).\n\n-   As amostras devem ser aleatórias e independentes (os dados de um grupo não devem influenciar os outros).\n\n-   As populações de onde as amostras foram retiradas devem ter variâncias semelhantes.\n\nDentro da ANOVA, os tipos mais comuns são a de um fator e a de dois fatores, dependendo de quantas variáveis você está investigando ao mesmo tempo.\n\n-   **ANOVA de um Fator**: É usada quando você compara grupos com base em apenas uma característica.\n\n    Exemplo: Suponha que um pesquisador queira comparar a mortalidade de uma praga (ex: mosca-branca) após a aplicação de três diferentes tipos de inseticidas (Inseticida A, Inseticida B e Inseticida C). A ANOVA de um fator ajudaria a determinar se há uma diferença significativa na mortalidade da praga entre os inseticidas testados.\n\n-   **ANOVA de Dois Fatores**: É usada quando você compara grupos com base em duas características ao mesmo tempo.\n\n    Exemplo: Imagine que você quer analisar o número de ovos depositados por uma lagarta em diferentes cultivares de soja (Cultivar 1, Cultivar 2) e também considerar a temperatura ambiente (25°C, 30°C). A ANOVA de dois fatores permitiria analisar o efeito combinado da cultivar e da temperatura no número de ovos depositados pela lagarta.\n\n#### Interpretação do P-valor na ANOVA\n\nNa ANOVA, se o **P-valor for igual ou menor que 0,05** (um nível de significância comum de α=0,05), você rejeita a hipótese nula (que todas as médias populacionais são iguais) e conclui que pelo menos uma das médias é diferente das outras. Isso significa que há uma diferença estatisticamente significativa entre os grupos que você está comparando.\n\nSe o **P-valor for maior que 0,05**, você aceita a hipótese nula, o que indica que não há evidências suficientes para dizer que as médias populacionais são diferentes. Nesse caso, a diferença observada entre as médias dos seus grupos é provavelmente devido ao acaso.\n\nPacotes que ainda não foram usados neste site e precisam ser instalados\n\n```{r, echo=TRUE, eval=FALSE}\ninstall.packages(\"emmeans\")\ninstall.packages(\"multcomp\")\n\n```\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(gsheet)\nlibrary(ggplot2)\n\nmicelial <- gsheet2tbl (\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\n# Visualizando os dados com um gráfico de boxplot\nmicelial |> \n  ggplot(aes(especie, tcm)) +\n  geom_boxplot(outlier.colour = NA) + # Removendo os outliers do boxplot\n  geom_jitter() # Adicionando pontos para visualização\n```\n\n#### Realizando a ANOVA com um fator\n\nAgora, vamos realizar a ANOVA para testar se existe uma diferença significativa entre as médias de tcm para diferentes especies.\n\n```{r, message=FALSE, warning=FALSE}\nlibrary(rstatix)\nanova1 <- aov(tcm ~ especie, data = micelial)\nanova1\n\n```\n\nAlternativamente, podemos realizar a ANOVA utilizando a função **`lm()`**, que também realiza uma análise de regressão linear. O resultado será o mesmo.\n\n```{r, message=FALSE, warning=FALSE}\n# ANOVA utilizando a regressão linear\nanova2 <- lm(tcm ~ especie, data = micelial)\nanova2\n\n# Comparando os resultados da ANOVA\nanova(anova1)\nanova(anova2)\n\n```\n\nA função **`anova()`** mostra a tabela de ANOVA com os valores de F e p, que nos ajudam a verificar se a diferença entre as médias é significativa.\n\n#### Verificando os Resíduos\n\nAntes de interpretar os resultados da ANOVA, precisamos verificar se os pressupostos de normalidade e homogeneidade das variâncias são atendidos. Para isso, vamos analisar os resíduos da ANOVA.\n\n```{r, message=FALSE, warning=FALSE}\n# Obtendo os resíduos da ANOVA\nresiduals(anova1) \n\n# Visualizando os resíduos em um histograma\nhist(residuals(anova1))\n\n# Realizando o teste de normalidade de Shapiro-Wilk nos resíduos\nshapiro.test(residuals(anova1))\n\n```\n\nQuando o valor de p for maior que 0,05 no teste de Shapiro-Wilk, podemos concluir que os resíduos são normalmente distribuídos.\n\n#### Testando a Homogeneidade das Variâncias\n\nA ANOVA pressupõe que as variâncias dos grupos sejam homogêneas. Podemos testar isso de duas maneiras: utilizando o **Teste de Bartlett** ou o **Teste de Levene**.\n\n```{r, message=FALSE, warning=FALSE}\n# Teste de Bartlett para homogeneidade de variâncias\nbartlett.test(tcm ~ especie, data = micelial)\n\n# Teste de Levene para homogeneidade de variâncias\nlevene_test(tcm ~ especie, data = micelial)\n\n```\n\nAmbos os testes verificam se as variâncias dos grupos são iguais. Se o valor p for maior que 0,05, as variâncias podem ser consideradas homogêneas.\n\n*O **Teste de Bartlett** verifica a homogeneidade das variâncias e é mais eficaz quando os dados seguem uma distribuição normal. Ele tem maior poder para identificar diferenças nas variâncias quando a normalidade é atendida.*\n\n*\\\nO **Teste de Levene** também testa a homogeneidade das variâncias, mas é mais confiável em casos de desvios da normalidade. Ele é ideal para quando os dados não seguem uma distribuição normal perfeita.*\n\n### Realizando Contrastes e Estimativas de Médias\n\nApós a ANOVA, podemos realizar contrastes para comparar as médias entre os grupos utilizando o pacote `emmeans`.\n\n```{r, message=FALSE, warning=FALSE}\n# Carregando o pacote 'emmeans' para contrastes\nlibrary(emmeans)\n\n# Realizando os contrastes das médias\nm <- emmeans(anova2, ~ especie)\nm\n\n```\n\nO pacote **emmeans()** permite que você calcule médias ajustadas para as variáveis de interesse, com base no modelo estimado. O pacote também permite que você faça comparações entre médias ajustadas usando contrastes, que podem incluir comparações múltiplas ou post-hoc (para analisar mais detalhadamente onde estão as diferenças entre os grupos). Ele também calcula intervalos de confiança para as médias ajustadas, permitindo uma compreensão mais detalhada da variabilidade dos dados.\n\n#### Comparações Múltiplas (Post-Hoc)\n\nSe a ANOVA indicar que existem diferenças significativas, podemos realizar comparações múltiplas para identificar quais grupos são diferentes entre si. O pacote **`multcomp`** é utilizado para essas comparações.\n\n```{r, message=FALSE, warning=FALSE}\n# Carregando o pacote 'multcomp'\nlibrary(multcomp)\n\n# Realizando comparações múltiplas\ncld(m)  # Mostra as letras compactas (grupos que são semelhantes)\n\n# Realizando comparações pareadas\npairs(m)\n\n# Fazendo uma matriz de resultados\npwpm(m)\n\n```\n\nO pacote **`multcomp`** é utilizado para realizar **comparações múltiplas** (post-hoc) após modelos lineares ou ANOVA. Ele ajuda a comparar as médias de diferentes grupos, ajustando para múltiplas comparações e controlando o erro tipo I.\n\nA função `cld()` exibe as letras compactas, que indicam quais grupos são significativamente diferentes. As comparações pareadas são feitas com a função `pairs()`, e a função `pwpm()` gera uma matriz de resultados.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"anova.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"journal","title":"Anova"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}