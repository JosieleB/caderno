{
  "hash": "579182c57398465d2ed19bb74e196ac3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Anova\"\n---\n\n\n\n\nQuando você precisa comparar as médias de três ou mais grupos, a Análise de Variância (ANOVA) é a ferramenta estatística ideal. Para que a ANOVA seja aplicada corretamente, seus dados precisam atender aos seguintes critérios:\n\n-   As amostras devem seguir uma distribuição paramétrica (geralmente normal).\n\n-   As amostras devem ser aleatórias e independentes (os dados de um grupo não devem influenciar os outros).\n\n-   As populações de onde as amostras foram retiradas devem ter variâncias semelhantes.\n\nDentro da ANOVA, os tipos mais comuns são a de um fator e a de dois fatores, dependendo de quantas variáveis você está investigando ao mesmo tempo.\n\n-   **ANOVA de um Fator**: É usada quando você compara grupos com base em apenas uma característica.\n\n    Exemplo: Suponha que um pesquisador queira comparar a mortalidade de uma praga (ex: mosca-branca) após a aplicação de três diferentes tipos de inseticidas (Inseticida A, Inseticida B e Inseticida C). A ANOVA de um fator ajudaria a determinar se há uma diferença significativa na mortalidade da praga entre os inseticidas testados.\n\n-   **ANOVA de Dois Fatores**: É usada quando você compara grupos com base em duas características ao mesmo tempo.\n\n    Exemplo: Imagine que você quer analisar o número de ovos depositados por uma lagarta em diferentes cultivares de soja (Cultivar 1, Cultivar 2) e também considerar a temperatura ambiente (25°C, 30°C). A ANOVA de dois fatores permitiria analisar o efeito combinado da cultivar e da temperatura no número de ovos depositados pela lagarta.\n\n#### Interpretação do P-valor na ANOVA\n\nNa ANOVA, se o **P-valor for igual ou menor que 0,05** (um nível de significância comum de α=0,05), você rejeita a hipótese nula (que todas as médias populacionais são iguais) e conclui que pelo menos uma das médias é diferente das outras. Isso significa que há uma diferença estatisticamente significativa entre os grupos que você está comparando.\n\nSe o **P-valor for maior que 0,05**, você aceita a hipótese nula, o que indica que não há evidências suficientes para dizer que as médias populacionais são diferentes. Nesse caso, a diferença observada entre as médias dos seus grupos é provavelmente devido ao acaso.\n\nPacotes que ainda não foram usados neste site e precisam ser instalados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"emmeans\")\ninstall.packages(\"multcomp\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nlibrary(ggplot2)\n\nmicelial <- gsheet2tbl (\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=959387827#gid=959387827\")\n\n# Visualizando os dados com um gráfico de boxplot\nmicelial |> \n  ggplot(aes(especie, tcm)) +\n  geom_boxplot(outlier.colour = NA) + # Removendo os outliers do boxplot\n  geom_jitter() # Adicionando pontos para visualização\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Realizando a ANOVA com um fator\n\nAgora, vamos realizar a ANOVA para testar se existe uma diferença significativa entre as médias de tcm para diferentes especies.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rstatix)\nanova1 <- aov(tcm ~ especie, data = micelial)\nanova1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = tcm ~ especie, data = micelial)\n\nTerms:\n                  especie Residuals\nSum of Squares  1.4695800 0.4679167\nDeg. of Freedom         4        25\n\nResidual standard error: 0.1368089\nEstimated effects may be unbalanced\n```\n\n\n:::\n:::\n\n\n\n\nAlternativamente, podemos realizar a ANOVA utilizando a função **`lm()`**, que também realiza uma análise de regressão linear. O resultado será o mesmo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANOVA utilizando a regressão linear\nanova2 <- lm(tcm ~ especie, data = micelial)\nanova2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nCoefficients:\n(Intercept)  especieFaus  especieFcor  especieFgra  especieFmer  \n      1.572       -0.335       -0.250       -0.660       -0.145  \n```\n\n\n:::\n\n```{.r .cell-code}\n# Comparando os resultados da ANOVA\nanova(anova1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nanova(anova2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\nA função **`anova()`** mostra a tabela de ANOVA com os valores de F e p, que nos ajudam a verificar se a diferença entre as médias é significativa.\n\n#### Verificando os Resíduos\n\nAntes de interpretar os resultados da ANOVA, precisamos verificar se os pressupostos de normalidade e homogeneidade das variâncias são atendidos. Para isso, vamos analisar os resíduos da ANOVA.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtendo os resíduos da ANOVA\nresiduals(anova1) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          1           2           3           4           5           6 \n-0.07166667  0.01833333 -0.05166667 -0.05166667  0.02833333  0.12833333 \n          7           8           9          10          11          12 \n 0.28333333  0.01333333  0.03333333  0.06333333 -0.15666667 -0.23666667 \n         13          14          15          16          17          18 \n-0.10166667 -0.08166667 -0.12166667  0.06833333  0.10833333  0.12833333 \n         19          20          21          22          23          24 \n-0.03166667  0.06833333 -0.20166667  0.08833333 -0.01166667  0.08833333 \n         25          26          27          28          29          30 \n 0.12333333  0.19333333  0.14333333 -0.11666667 -0.14666667 -0.19666667 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualizando os resíduos em um histograma\nhist(residuals(anova1))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Realizando o teste de normalidade de Shapiro-Wilk nos resíduos\nshapiro.test(residuals(anova1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  residuals(anova1)\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n:::\n\n\n\n\nQuando o valor de p for maior que 0,05 no teste de Shapiro-Wilk, podemos concluir que os resíduos são normalmente distribuídos.\n\n#### Testando a Homogeneidade das Variâncias\n\nA ANOVA pressupõe que as variâncias dos grupos sejam homogêneas. Podemos testar isso de duas maneiras: utilizando o **Teste de Bartlett** ou o **Teste de Levene**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Teste de Bartlett para homogeneidade de variâncias\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de Levene para homogeneidade de variâncias\nlevene_test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 4\n    df1   df2 statistic     p\n  <int> <int>     <dbl> <dbl>\n1     4    25      1.76 0.169\n```\n\n\n:::\n:::\n\n\n\n\nAmbos os testes verificam se as variâncias dos grupos são iguais. Se o valor p for maior que 0,05, as variâncias podem ser consideradas homogêneas.\n\n*O **Teste de Bartlett** verifica a homogeneidade das variâncias e é mais eficaz quando os dados seguem uma distribuição normal. Ele tem maior poder para identificar diferenças nas variâncias quando a normalidade é atendida.*\n\n*\\\nO **Teste de Levene** também testa a homogeneidade das variâncias, mas é mais confiável em casos de desvios da normalidade. Ele é ideal para quando os dados não seguem uma distribuição normal perfeita.*\n\n### Realizando Contrastes e Estimativas de Médias\n\nApós a ANOVA, podemos realizar contrastes para comparar as médias entre os grupos utilizando o pacote `emmeans`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregando o pacote 'emmeans' para contrastes\nlibrary(emmeans)\n\n# Realizando os contrastes das médias\nm <- emmeans(anova2, ~ especie)\nm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\n\n\nO pacote **emmeans()** permite que você calcule médias ajustadas para as variáveis de interesse, com base no modelo estimado. O pacote também permite que você faça comparações entre médias ajustadas usando contrastes, que podem incluir comparações múltiplas ou post-hoc (para analisar mais detalhadamente onde estão as diferenças entre os grupos). Ele também calcula intervalos de confiança para as médias ajustadas, permitindo uma compreensão mais detalhada da variabilidade dos dados.\n\n#### Comparações Múltiplas (Post-Hoc)\n\nSe a ANOVA indicar que existem diferenças significativas, podemos realizar comparações múltiplas para identificar quais grupos são diferentes entre si. O pacote **`multcomp`** é utilizado para essas comparações.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregando o pacote 'multcomp'\nlibrary(multcomp)\n\n# Realizando comparações múltiplas\ncld(m)  # Mostra as letras compactas (grupos que são semelhantes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Realizando comparações pareadas\npairs(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast    estimate    SE df t.ratio p.value\n Fasi - Faus    0.335 0.079 25   4.241  0.0023\n Fasi - Fcor    0.250 0.079 25   3.165  0.0302\n Fasi - Fgra    0.660 0.079 25   8.356  <.0001\n Fasi - Fmer    0.145 0.079 25   1.836  0.3765\n Faus - Fcor   -0.085 0.079 25  -1.076  0.8169\n Faus - Fgra    0.325 0.079 25   4.115  0.0031\n Faus - Fmer   -0.190 0.079 25  -2.405  0.1469\n Fcor - Fgra    0.410 0.079 25   5.191  0.0002\n Fcor - Fmer   -0.105 0.079 25  -1.329  0.6761\n Fgra - Fmer   -0.515 0.079 25  -6.520  <.0001\n\nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n\n\n:::\n\n```{.r .cell-code}\n# Fazendo uma matriz de resultados\npwpm(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Fasi    Faus    Fcor    Fgra    Fmer\nFasi [1.572]  0.0023  0.0302  <.0001  0.3765\nFaus   0.335 [1.237]  0.8169  0.0031  0.1469\nFcor   0.250  -0.085 [1.322]  0.0002  0.6761\nFgra   0.660   0.325   0.410 [0.912]  <.0001\nFmer   0.145  -0.190  -0.105  -0.515 [1.427]\n\nRow and column labels: especie\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n\n\n\nO pacote **`multcomp`** é utilizado para realizar **comparações múltiplas** (post-hoc) após modelos lineares ou ANOVA. Ele ajuda a comparar as médias de diferentes grupos, ajustando para múltiplas comparações e controlando o erro tipo I.\n\nA função `cld()` exibe as letras compactas, que indicam quais grupos são significativamente diferentes. As comparações pareadas são feitas com a função `pairs()`, e a função `pwpm()` gera uma matriz de resultados.\n",
    "supporting": [
      "anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}