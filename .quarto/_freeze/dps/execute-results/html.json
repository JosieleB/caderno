{
  "hash": "86a1365b630e0d04292c3de05e6f6e79",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Anova em delineamento de Parcelas Subdivididas\"\n---\n\n\n\n\nO Delineamento em Parcelas Subdivididas (ou Split-Plot Design) é um tipo de plano experimental utilizado para estudar múltiplos fatores em um experimento, onde os fatores têm níveis distintos e são manipulados de maneira hierárquica, ou seja, um fator é manipulado em um nível maior (parcela principal) e o outro fator é manipulado em níveis menores (parcelas subdivididas). Este tipo de delineamento é frequentemente utilizado em experimentos agrícolas, industriais e experimentos de campo, quando há limitações de tempo, espaço ou recursos para realizar todos os tratamentos de forma independente.\n\n\n\n\n::: {.cell hide='true'}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(DHARMa)\nlibrary(multcomp)\n\n# Carregar os dados da nuvem\nlibrary(gsheet)\nmilho <- gsheet2tbl (\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1345524759#gid=1345524759\")\n\n# Visualizando os dados: gráfico de dispersão com 'hybrid' no eixo X, 'index' no eixo Y e cores diferenciadas por 'method'\nmilho |> \n  ggplot(aes(hybrid, index, color = method)) + \n  geom_jitter(width = 0.1) +          # Adiciona dispersão nos pontos para facilitar a visualização\n  coord_flip() +                      # Inverte os eixos X e Y\n  facet_wrap(~ method)                # Cria facetas (subgráficos) para cada valor de 'method'\n```\n\n::: {.cell-output-display}\n![](dps_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Instalar e carregar o pacote lme4 para usar modelos mistos\ninstall.packages(\"lme4\") \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\npacote 'lme4' desempacotado com sucesso e somas MD5 verificadas\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nOs pacotes binários baixados estão em\n\tC:\\Users\\Public\\Documents\\Wondershare\\CreatorTemp\\Rtmp2v31vq\\downloaded_packages\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(lme4)\n\n# Criando a variável de interação entre 'hybrid' e 'block'\nmilho$hybrid_block <- interaction(milho$hybrid, milho$block)  # Cria uma nova variável que representa a interação entre híbrido e bloco\n\n# Outra forma de criar a interação 'hybrid' e 'block'\nmilho |> \n  mutate(hybrid_block = interaction(hybrid, block)) # Criação da interação com mutate, que também adiciona essa variável ao dataframe\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 48 × 6\n   hybrid   block method index yield hybrid_block\n   <chr>    <dbl> <chr>  <dbl> <dbl> <fct>       \n 1 30F53 HX     1 pin     21.1 12920 30F53 HX.1  \n 2 30F53 HX     2 pin     21.1  9870 30F53 HX.2  \n 3 30F53 HX     3 pin     23.3  8920 30F53 HX.3  \n 4 30F53 HX     4 pin     35.6 13120 30F53 HX.4  \n 5 30F53 YH     1 pin     21.1 12060 30F53 YH.1  \n 6 30F53 YH     2 pin     22.2  7860 30F53 YH.2  \n 7 30F53 YH     3 pin     27.3  7410 30F53 YH.3  \n 8 30F53 YH     4 pin     27.8 10300 30F53 YH.4  \n 9 30K64        1 pin     20   11700 30K64.1     \n10 30K64        2 pin     20   10700 30K64.2     \n# ℹ 38 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# Ajustando o modelo misto para analisar 'index' com os fatores 'hybrid' e 'method', considerando blocos como um efeito aleatório\nm_milho <- lmer(index ~ hybrid * method + \n                (1 | block:hybrid_block),  # Bloco dentro da interação híbrido-bloco\n                data = milho)\n\n# Exibindo a ANOVA do modelo\ncar::Anova(m_milho)  # 'car::Anova' é usado para uma ANOVA mais detalhada com modelos lineares e mistos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nhybrid        11.4239  5    0.04359 * \nmethod         4.6964  1    0.03023 * \nhybrid:method 15.8062  5    0.00742 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualizando os resíduos do modelo para verificar a normalidade e homogeneidade das variâncias\nplot(simulateResiduals(m_milho))  # Usando DHARMa para verificar os resíduos do modelo\n```\n\n::: {.cell-output-display}\n![](dps_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Estimativas das médias ajustadas para cada 'hybrid' dentro de cada 'method'\nlibrary(emmeans)  # Pacote para estimativas de médias ajustadas\nmedia_milho <- emmeans(m_milho, ~ hybrid | method)  # Calculando as médias ajustadas para 'hybrid' dentro de cada 'method'\ncld(media_milho, Letters = letters)  # Exibindo as comparações de médias com as letras compactas\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    19.4 3.57 24.9     12.1     26.8  a    \n 30K64      20.6 3.57 24.9     13.2     27.9  a    \n 30F53 YH   24.6 3.57 24.9     17.3     31.9  ab   \n 30F53 HX   25.3 3.57 24.9     17.9     32.6  ab   \n 30S31YH    32.5 3.57 24.9     25.2     39.8  ab   \n 30S31H     38.1 3.57 24.9     30.8     45.4   b   \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    19.2 3.57 24.9     11.8     26.5  a    \n 30K64      21.5 3.57 24.9     14.2     28.8  a    \n 30F53 HX   25.0 3.57 24.9     17.7     32.3  a    \n 30F53 YH   26.2 3.57 24.9     18.9     33.6  a    \n 30S31H     26.5 3.57 24.9     19.2     33.8  a    \n 30S31YH    26.6 3.57 24.9     19.3     34.0  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Decompondo as médias por 'method' dentro de cada 'hybrid'\nmedia_milho2 <- emmeans(m_milho, ~ method | hybrid)  # Calculando as médias ajustadas para 'method' dentro de cada 'hybrid'\ncld(media_milho2, Letters = letters)  # Exibindo as comparações de médias\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nhybrid = 30F53 HX:\n method emmean   SE   df lower.CL upper.CL .group\n silk     25.0 3.57 24.9     17.7     32.3  a    \n pin      25.3 3.57 24.9     17.9     32.6  a    \n\nhybrid = 30F53 YH:\n method emmean   SE   df lower.CL upper.CL .group\n pin      24.6 3.57 24.9     17.3     31.9  a    \n silk     26.2 3.57 24.9     18.9     33.6  a    \n\nhybrid = 30K64:\n method emmean   SE   df lower.CL upper.CL .group\n pin      20.6 3.57 24.9     13.2     27.9  a    \n silk     21.5 3.57 24.9     14.2     28.8  a    \n\nhybrid = 30S31H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.5 3.57 24.9     19.2     33.8  a    \n pin      38.1 3.57 24.9     30.8     45.4   b   \n\nhybrid = 30S31YH:\n method emmean   SE   df lower.CL upper.CL .group\n silk     26.6 3.57 24.9     19.3     34.0  a    \n pin      32.5 3.57 24.9     25.2     39.8  a    \n\nhybrid = BG7049H:\n method emmean   SE   df lower.CL upper.CL .group\n silk     19.2 3.57 24.9     11.8     26.5  a    \n pin      19.4 3.57 24.9     12.1     26.8  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Realizando a análise com a ANOVA sem considerar o modelo de parcelas subdivididas (não recomendado)\nm_milho3 <- lm(index ~ hybrid * method + block, data = milho)  # Modelo linear simples, sem efeito aleatório\nplot(simulateResiduals(m_milho3))  # Visualizando os resíduos para este modelo simplificado\n```\n\n::: {.cell-output-display}\n![](dps_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Agora, analisando a produtividade (yield) em vez do índice\nm_milho <- lmer(yield ~ hybrid * method + \n                (1 | block:hybrid_block),  # Mantendo a interação entre blocos e híbridos\n                data = milho)\n\n# Exibindo a ANOVA para o modelo de produtividade\ncar::Anova(m_milho)  # Exibe a ANOVA para o modelo ajustado\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: yield\n                Chisq Df Pr(>Chisq)    \nhybrid        22.5966  5  0.0004031 ***\nmethod         0.1052  1  0.7456932    \nhybrid:method 25.9302  5  9.206e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualizando os resíduos para verificar os pressupostos da ANOVA\nplot(simulateResiduals(m_milho))  # Checando os resíduos para produtividade\n```\n\n::: {.cell-output-display}\n![](dps_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# Estimativas das médias ajustadas para 'hybrid' dentro de 'method' para a produtividade\nmedia_milho <- emmeans(m_milho, ~ hybrid | method)\ncld(media_milho, Letters = letters)  # Exibindo as comparações entre os híbridos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmethod = pin:\n hybrid   emmean  SE   df lower.CL upper.CL .group\n 30S31YH    7836 798 21.1     6177     9495  a    \n 30S31H     8118 798 21.1     6459     9777  a    \n 30F53 YH   9408 798 21.1     7748    11067  ab   \n 30F53 HX  11208 798 21.1     9548    12867  ab   \n 30K64     11675 798 21.1    10016    13334   b   \n BG7049H   11970 798 21.1    10311    13629   b   \n\nmethod = silk:\n hybrid   emmean  SE   df lower.CL upper.CL .group\n 30S31YH    8277 798 21.1     6618     9936  a    \n 30S31H     9185 798 21.1     7526    10844  a    \n 30F53 YH   9211 798 21.1     7552    10870  a    \n 30F53 HX   9988 798 21.1     8328    11647  ab   \n 30K64     10361 798 21.1     8702    12020  ab   \n BG7049H   12833 798 21.1    11174    14492   b   \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Estimativas das médias ajustadas para 'method' dentro de 'hybrid' para a produtividade\nmedia_milho2 <- emmeans(m_milho, ~ method | hybrid)\ncld(media_milho2, Letters = letters)  # Exibindo as comparações entre os métodos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nhybrid = 30F53 HX:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9988 798 21.1     8328    11647  a    \n pin     11208 798 21.1     9548    12867   b   \n\nhybrid = 30F53 YH:\n method emmean  SE   df lower.CL upper.CL .group\n silk     9211 798 21.1     7552    10870  a    \n pin      9408 798 21.1     7748    11067  a    \n\nhybrid = 30K64:\n method emmean  SE   df lower.CL upper.CL .group\n silk    10361 798 21.1     8702    12020  a    \n pin     11675 798 21.1    10016    13334   b   \n\nhybrid = 30S31H:\n method emmean  SE   df lower.CL upper.CL .group\n pin      8118 798 21.1     6459     9777  a    \n silk     9185 798 21.1     7526    10844   b   \n\nhybrid = 30S31YH:\n method emmean  SE   df lower.CL upper.CL .group\n pin      7836 798 21.1     6177     9495  a    \n silk     8277 798 21.1     6618     9936  a    \n\nhybrid = BG7049H:\n method emmean  SE   df lower.CL upper.CL .group\n pin     11970 798 21.1    10311    13629  a    \n silk    12833 798 21.1    11174    14492  a    \n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Analisando a relação entre índice e produtividade (doença e produtividade)\nmilho |> \n  ggplot(aes(index, yield)) + \n  geom_point() +            # Gráfico de dispersão entre índice e produtividade\n  geom_smooth(method = \"lm\")  # Adicionando a linha de tendência com o modelo linear\n```\n\n::: {.cell-output-display}\n![](dps_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# Análise de correlação entre 'index' (índice de doença) e 'yield' (produtividade)\ncor.test(milho$index, milho$yield)  # Testando a correlação entre o índice de doença e a produtividade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  milho$index and milho$yield\nt = -1.7622, df = 46, p-value = 0.08468\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.49988704  0.03517829\nsample estimates:\n       cor \n-0.2514699 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Calculando o coeficiente de correlação e o coeficiente de determinação (R^2)\ncor1 <- cor(milho$index, milho$yield)  # Calculando o coeficiente de correlação\ncor1 * cor1 * 100  # Calculando o coeficiente de determinação (R^2), que mostra a variação de 'yield' explicada por 'index'\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.323713\n```\n\n\n:::\n:::\n",
    "supporting": [
      "dps_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}