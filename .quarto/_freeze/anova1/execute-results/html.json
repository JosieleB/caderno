{
  "hash": "7ae4e7eccc0c320ccb6de691ab2c5516",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Anova de dois fatores ou mais\"\n---\n\n\n\n\nA ANOVA de dois fatores é usada quando queremos analisar o efeito de dois fatores diferentes ao mesmo tempo. No nosso exemplo, estamos analisando o efeito do tratamento e da dose no nível de severidade de uma doença (por exemplo, fungos em plantas).\n\n### Pressupostos da ANOVA de dois fatores\n\nAntes de aplicar a ANOVA de dois fatores, devemos garantir que os dados atendem aos seguintes pressupostos:\n\n1.  Normalidade: Os dados devem seguir uma distribuição normal (testado usando o teste de Shapiro-Wilk nos resíduos).\n2.  Independência: As amostras devem ser aleatórias e independentes.\n3.  Homogeneidade das Variâncias: As variâncias entre os grupos devem ser semelhantes (testado utilizando o Teste de Bartlett ou Levene).\n\nPacotes que ainda não foram usados neste site e precisam ser instalados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"epifitter\")\ninstall.packages(\"DHARMa\")\ninstall.packages(\"performance\")\n```\n:::\n\n\n\n\n### Visualizando os Dados\n\nA primeira coisa a fazer é visualizar os dados usando gráficos para entender sua distribuição.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(gsheet)\n\n# Carregando os dados\nfung_vaso <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=2023059672#gid=2023059672\")\n\n# Visualizando os dados com um gráfico de jitter\nfung_vaso |> \n  ggplot(aes(factor(dose), severity*100)) +  # Transformando dose em um fator\n  geom_jitter(width = 0.1) +  # Adicionando dispersão para visualização\n  facet_wrap(~ treat)  # Dividindo por tratamento\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n### Realizando a ANOVA de dois fatores\n\nAgora, vamos realizar a ANOVA de dois fatores para testar se existe uma diferença significativa na severidade da doença, levando em consideração tanto o tratamento quanto a dose.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ajustando o modelo de ANOVA de dois fatores\nm_anti <- lm(severity ~ treat * dose, data = fung_vaso)\n\n# Realizando a ANOVA\nanova(m_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n### Verificando os resíduos\n\nAntes de interpretar os resultados, é importante verificar se os pressupostos de normalidade e homogeneidade das variâncias são atendidos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregando o pacote DHARMa\nlibrary(DHARMa)\n\n# Verificando os resíduos da ANOVA\nplot(simulateResiduals(m_anti))  # Visualizando os resíduos\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n### Estimativas de médias\n\nAgora, podemos usar o pacote `emmeans` para calcular as médias ajustadas e realizar comparações entre os grupos, levando em consideração o efeito combinado de tratamento e dose.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nlibrary(multcomp)\n\n# Realizando estimativas das médias ajustadas para cada tratamento dentro das doses\nmedia_anti <- emmeans(m_anti, ~ treat | dose)\nmedia_anti  # Exibindo as médias ajustadas\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789\n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Comparações estatísticas entre os grupos\ncld(media_anti)  # Exibindo as letras compactas para comparações\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  1    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   2   \n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  1    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Realizando a decomposição das médias por dose dentro de cada tratamento\nmedia_anti <- emmeans(m_anti, ~ dose | treat)\nmedia_anti  # Exibindo as médias ajustadas por dose\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.2921 0.0273 16  0.23420   0.3500\n  2.0 0.0501 0.0273 16 -0.00781   0.1080\n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.0210 0.0273 16 -0.03690   0.0789\n  2.0 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Comparações estatísticas entre os grupos\ncld(media_anti)  # Exibindo as letras compactas para comparações\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n### Visualizando a interação\n\nPodemos verificar visualmente se existe uma interação entre o tratamento e a dose. Uma maneira simples de fazer isso é utilizando um gráfico de interação.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gráfico de interação\ninteraction.plot(fung_vaso$treat, fung_vaso$dose, fung_vaso$severity)\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\nSe as linhas no gráfico não forem paralelas, isso indica uma interação significativa entre os fatores. Se forem paralelas, a interação é provavelmente não significativa.\n\nA ANOVA fatorial é uma técnica estatística usada para analisar o impacto de dois ou mais fatores (variáveis independentes) sobre uma variável dependente, considerando tanto os efeitos principais de cada fator quanto as possíveis interações entre os fatores.\n\n-   Efeitos principais: Analisam o impacto de cada fator isoladamente.\n-   Interação: Verifica se o efeito de um fator depende do nível de outro fator.\n\nNeste exemplo, a ANOVA fatorial será utilizada para analisar o impacto de três fatores: tratamento, dose e irrigação, na severidade de uma doença (representada pela AUDPC - Área Sob a Curva do Progresso da Doença). O objetivo é entender como esses fatores e suas interações afetam a severidade da doença.\n\n### Expansão da Análise\n\nAgora, vamos expandir a análise para incluir um terceiro fator: o tipo de irrigação. Realizaremos a ANOVA fatorial para três fatores: tratamento, dose e irrigação.\n\nA seguir, faremos uma análise detalhada dos efeitos principais de cada fator e das interações entre eles na severidade da doença.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar pacotes necessários\nlibrary(epifitter)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(emmeans)\nlibrary(DHARMa)\n\n# Carregar o conjunto de dados\noidio <- PowderyMildew\n\n# Filtrando os dados para as condições desejadas de irrigação\noidio |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |> \n  ggplot(aes(time, sev * 100)) + \n  geom_jitter(width = 0.1) + \n  facet_grid(moisture ~ irrigation_type)  # Visualização dos dados\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Sumarizando a área abaixo da curva (AUDPC) por tratamento e bloco\noidio3 <- oidio |> \n  group_by(irrigation_type, moisture, block) |> \n  summarize(AUDPC = sum(sev))  # Alteração do cálculo de AUDPC para somatório de 'sev' (ou pode ser outra fórmula)\n\n# Visualizando os dados de AUDPC\noidio3 |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |> \n  ggplot(aes(irrigation_type, AUDPC, color = moisture)) +\n  geom_point(width = 0.1) +\n  scale_y_continuous(limits = c(0, 20))  # Ajustando limites do eixo Y\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Realizando a ANOVA fatorial para AUDPC\noidio4 <- oidio3 |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\"))\n\n# Ajustando o modelo de ANOVA fatorial\nanov_oidio <- lm(AUDPC ~ irrigation_type * moisture, data = oidio4)\n\n# Exibindo os resultados da ANOVA\nanova(anov_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: AUDPC\n                         Df Sum Sq Mean Sq F value    Pr(>F)    \nirrigation_type           2 3.5877 1.79385 551.709  1.55e-12 ***\nmoisture                  1 0.1594 0.15942  49.032  1.43e-05 ***\nirrigation_type:moisture  2 0.1187 0.05935  18.253 0.0002292 ***\nResiduals                12 0.0390 0.00325                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Verificando os resíduos da ANOVA\nplot(simulateResiduals(anov_oidio))\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Estimativas das médias ajustadas\nmedias_oidio <- emmeans(anov_oidio, ~ irrigation_type | moisture)\nmedias_oidio  # Exibindo as médias ajustadas\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmoisture = High moisture:\n irrigation_type emmean     SE df lower.CL upper.CL\n MS               1.396 0.0329 12    1.324    1.467\n MS above canopy  0.647 0.0329 12    0.576    0.719\n Overhead         0.590 0.0329 12    0.519    0.662\n\nmoisture = Moderate moisture:\n irrigation_type emmean     SE df lower.CL upper.CL\n MS               1.804 0.0329 12    1.732    1.876\n MS above canopy  0.782 0.0329 12    0.711    0.854\n Overhead         0.612 0.0329 12    0.540    0.683\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Comparações das médias ajustadas entre os grupos\ncld(medias_oidio)  # Comparação estatística entre os grupos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmoisture = High moisture:\n irrigation_type emmean     SE df lower.CL upper.CL .group\n Overhead         0.590 0.0329 12    0.519    0.662  1    \n MS above canopy  0.647 0.0329 12    0.576    0.719  1    \n MS               1.396 0.0329 12    1.324    1.467   2   \n\nmoisture = Moderate moisture:\n irrigation_type emmean     SE df lower.CL upper.CL .group\n Overhead         0.612 0.0329 12    0.540    0.683  1    \n MS above canopy  0.782 0.0329 12    0.711    0.854   2   \n MS               1.804 0.0329 12    1.732    1.876    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n# Decompondo as médias por 'moisture' dentro de cada tipo de irrigação\nmedias_oidio2 <- emmeans(anov_oidio, ~ moisture | irrigation_type)\nmedias_oidio2  # Exibindo as médias ajustadas por 'moisture'\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nirrigation_type = MS:\n moisture          emmean     SE df lower.CL upper.CL\n High moisture      1.396 0.0329 12    1.324    1.467\n Moderate moisture  1.804 0.0329 12    1.732    1.876\n\nirrigation_type = MS above canopy:\n moisture          emmean     SE df lower.CL upper.CL\n High moisture      0.647 0.0329 12    0.576    0.719\n Moderate moisture  0.782 0.0329 12    0.711    0.854\n\nirrigation_type = Overhead:\n moisture          emmean     SE df lower.CL upper.CL\n High moisture      0.590 0.0329 12    0.519    0.662\n Moderate moisture  0.612 0.0329 12    0.540    0.683\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Comparando as médias ajustadas\ncld(medias_oidio2)  # Comparação estatística entre as médias ajustadas\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nirrigation_type = MS:\n moisture          emmean     SE df lower.CL upper.CL .group\n High moisture      1.396 0.0329 12    1.324    1.467  1    \n Moderate moisture  1.804 0.0329 12    1.732    1.876   2   \n\nirrigation_type = MS above canopy:\n moisture          emmean     SE df lower.CL upper.CL .group\n High moisture      0.647 0.0329 12    0.576    0.719  1    \n Moderate moisture  0.782 0.0329 12    0.711    0.854   2   \n\nirrigation_type = Overhead:\n moisture          emmean     SE df lower.CL upper.CL .group\n High moisture      0.590 0.0329 12    0.519    0.662  1    \n Moderate moisture  0.612 0.0329 12    0.540    0.683  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n|           | H. moisture | M. moisture |\n|-----------|-------------|-------------|\n| MS        | 8.52 Aa     | 11.18 Ab    |\n| MS Ac.    | 3.99 Ba     | 4.86 Bb     |\n| Overhead  | 3.68 Ba     | 3.81 Ca     |\n| CV = 6.41 |             |             |\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregando pacotes necessários\nlibrary(tidyverse)  # Para manipulação de dados e gráficos\nlibrary(readxl)     # Para ler arquivos Excel\nlibrary(Hmisc)      # Para análise estatística\n\n# Carregando os dados da planilha Excel\nfung_campo <- gsheet2tbl (\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=866852711#gid=866852711\")\n\n# Visualização dos dados com um gráfico de dispersão\nfung_campo |> \n  mutate (TRAT = factor(TRAT)) |>  # Transformando a variável 'TRAT' em fator (para garantir que o R trate os níveis como categorias)\n  ggplot(aes(TRAT, PROD)) +        # Criando o gráfico com 'TRAT' no eixo X e 'PROD' no eixo Y\n  geom_jitter(width = 0.2) +       # Adicionando dispersão nos pontos para visualização\n  stat_summary(                    # Adicionando a linha de média com intervalo de confiança\n    fun.data = \"mean_cl_boot\",      # Função para calcular a média com intervalo de confiança bootstrap\n    colour = \"red\",                 # Cor da linha de média\n    width = 0.3                     # Largura dos pontos\n  )\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Transformando as variáveis 'TRAT' e 'BLOCO' em fatores\n# (Por padrão, o R interpreta variáveis numéricas como contínuas, mas aqui queremos tratá-las como categorias)\nfung_campo$TRAT <- factor(fung_campo$TRAT)\nfung_campo$BLOCO <- factor(fung_campo$BLOCO)\n\n# Realizando a ANOVA para verificar o efeito dos fatores 'BLOCO' e 'TRAT' na variável 'PROD' (produção)\nanova_campo <- lm(PROD ~ BLOCO + TRAT, data = fung_campo)  # Modelo linear\nanova(anova_campo)  # Exibindo a tabela de ANOVA\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \nBLOCO      3  105665   35222  0.2171 0.88340  \nTRAT       7 2993906  427701  2.6367 0.04021 *\nResiduals 21 3406431  162211                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Testando os pressupostos da ANOVA: normalidade dos resíduos e homocedasticidade\nlibrary(DHARMa)  # Pacote para verificar resíduos\n\nplot(simulateResiduals(anova_campo))  # Simula e plota os resíduos para avaliar se há violação dos pressupostos\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Estimativas das médias ajustadas para o fator 'TRAT' (tratamento)\nlibrary(emmeans)  # Para calcular as médias ajustadas\nmeans_campo <- emmeans(anova_campo, ~ TRAT)  # Calcula as médias ajustadas para os tratamentos\nmeans_campo  # Exibe as médias ajustadas\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 201 21     3800     4638\n 2      4935 201 21     4516     5354\n 3      5110 201 21     4691     5529\n 4      5140 201 21     4721     5559\n 5      5122 201 21     4703     5541\n 6      5256 201 21     4837     5675\n 7      5128 201 21     4709     5546\n 8      5078 201 21     4659     5497\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Teste de médias entre os grupos\nlibrary(multcomp)  # Pacote para comparações múltiplas (post-hoc)\ncld(means_campo)  # Comparação entre os tratamentos, mostrando as letras compactas para indicar diferenças estatísticas\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  1    \n 2      4935 201 21     4516     5354  12   \n 8      5078 201 21     4659     5497  12   \n 3      5110 201 21     4691     5529  12   \n 5      5122 201 21     4703     5541  12   \n 7      5128 201 21     4709     5546  12   \n 4      5140 201 21     4721     5559  12   \n 6      5256 201 21     4837     5675   2   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(means_campo)  # Plota as médias ajustadas\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Comparações post-hoc com matriz de significância\npwpp(means_campo)  # Mostra as comparações entre tratamentos\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-4.png){width=672}\n:::\n\n```{.r .cell-code}\npwpm(means_campo)  # Exibe a matriz de comparações entre os grupos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7      8\n1  [4219]  0.2430  0.0792  0.0640  0.0728  0.0272  0.0700 0.0985\n2  -715.8  [4935]  0.9983  0.9953  0.9974  0.9430  0.9968 0.9995\n3  -890.8  -175.0  [5110]  1.0000  1.0000  0.9994  1.0000 1.0000\n4  -921.0  -205.3   -30.2  [5140]  1.0000  0.9999  1.0000 1.0000\n5  -902.8  -187.0   -12.0    18.3  [5122]  0.9997  1.0000 1.0000\n6 -1037.0  -321.3  -146.2  -116.0  -134.3  [5256]  0.9998 0.9981\n7  -908.3  -192.5   -17.5    12.8    -5.5   128.8  [5127] 1.0000\n8  -859.0  -143.2    31.8    62.0    43.8   178.0    49.2 [5078]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\n# Observação: Neste caso, não há diferença estatística significativa, embora haja um grande ganho de produção nos tratamentos. \n# Isso indica que o efeito do tratamento não é estatisticamente significativo, mas o efeito pode ser relevante do ponto de vista prático.\n\n# Analisando o efeito do 'TRAT' sobre a severidade da doença (variável 'FER' - ferrugem)\n\n# Realizando a ANOVA para a severidade (log-transformada para normalizar a distribuição)\nanova_fer <- lm(log(FER) ~ BLOCO + TRAT, data = fung_campo)\nanova(anova_fer)  # Exibindo a tabela de ANOVA para 'FER'\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nBLOCO      3  0.2064 0.06880  1.7961    0.1788    \nTRAT       7 11.5210 1.64585 42.9665 4.838e-11 ***\nResiduals 21  0.8044 0.03831                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Testando os resíduos da ANOVA para 'FER'\nplot(simulateResiduals(anova_fer))  # Verificando a normalidade e homocedasticidade\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# Estimando as médias ajustadas para 'TRAT' no modelo de severidade\nmeans_fer <- emmeans(anova_fer, ~ TRAT, type = \"response\")  # Usando 'type = response' para reverter a transformação logarítmica\nmeans_fer  # Exibe as médias ajustadas para 'FER'\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT response    SE df lower.CL upper.CL\n 1       20.02 1.960 21    16.33    24.54\n 2        5.68 0.556 21     4.63     6.96\n 3        3.81 0.373 21     3.11     4.67\n 4        3.08 0.301 21     2.51     3.78\n 5        3.24 0.317 21     2.64     3.97\n 6        2.98 0.292 21     2.43     3.65\n 7        3.37 0.330 21     2.75     4.13\n 8        3.48 0.341 21     2.84     4.27\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \n```\n\n\n:::\n\n```{.r .cell-code}\n# Comparação das médias ajustadas para 'TRAT'\ncld(means_fer)  # Comparação entre os tratamentos de severidade, com letras para indicar diferenças\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT response    SE df lower.CL upper.CL .group\n 6        2.98 0.292 21     2.43     3.65  1    \n 4        3.08 0.301 21     2.51     3.78  1    \n 5        3.24 0.317 21     2.64     3.97  1    \n 7        3.37 0.330 21     2.75     4.13  1    \n 8        3.48 0.341 21     2.84     4.27  1    \n 3        3.81 0.373 21     3.11     4.67  12   \n 2        5.68 0.556 21     4.63     6.96   2   \n 1       20.02 1.960 21    16.33    24.54    3  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 8 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(means_fer)  # Plota as médias ajustadas\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# Comparações post-hoc com matriz de significância\npwpp(means_fer)  # Mostra as comparações entre os tratamentos de severidade\n```\n\n::: {.cell-output-display}\n![](anova1_files/figure-html/unnamed-chunk-8-7.png){width=672}\n:::\n\n```{.r .cell-code}\npwpm(means_fer)  # Exibe a matriz de comparações entre os grupos de severidade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7       8\n1 [20.02]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   3.525 [ 5.68]  0.1252  0.0048  0.0110  0.0028  0.0204  0.0343\n3   5.259   1.492 [ 3.81]  0.7832  0.9335  0.6440  0.9843  0.9976\n4   6.500   1.844   1.236 [ 3.08]  0.9999  1.0000  0.9976  0.9842\n5   6.178   1.753   1.175   0.951 [ 3.24]  0.9984  1.0000  0.9994\n6   6.721   1.906   1.278   1.034   1.088 [ 2.98]  0.9842  0.9431\n7   5.945   1.686   1.130   0.915   0.962   0.885 [ 3.37]  1.0000\n8   5.750   1.631   1.093   0.885   0.931   0.856   0.967 [ 3.48]\n\nRow and column labels: TRAT\nUpper triangle: P values   null = 1  adjust = \"tukey\"\nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (ratio)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\n# Calculando o coeficiente de variação do modelo\nlibrary(agricolae)  # Pacote para análise agronômica\ncv.model(anova_fer)  # Calcula o coeficiente de variação do modelo para severidade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 13.13068\n```\n\n\n:::\n:::\n",
    "supporting": [
      "anova1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}