---
title: "Teste T"
---

O Teste T √© utilizado para testar uma hip√≥tese sobre uma m√©dia populacional. Os requisitos para a utiliza√ß√£o do Teste T s√£o: m√©todo de sele√ß√£o amostral aleat√≥ria, uma amostra com distribui√ß√£o normal (param√©trica) e cuja vari√°vel a ser analisada √© quantitativa. O Teste T √© robusto contra um afastamento da normalidade, portanto, deve ser utilizado somente em amostras com distribui√ß√£o param√©trica.

[Resumo Teste T]{.underline}

| Teste | Distribui√ß√£o | Grupos | Deped√™ncia | Resquisitos |
|----|----|----|----|----|
| T pareado | Param√©trico | 2 | Dependentes | Vari√¢ncias desconhecidas |
| T para duas amostras | Param√©trico | 2 | Independentes | Vari√¢ncias iguais |
| T para 2 amostras com vari√¢ncias diferentes | Param√©trico | 2 | Independentes | Vari√¢ncias diferentes |

üí°**Lembrete**

***Vari√°vel Independente**: √â a vari√°vel que o pesquisador manipula ou divide os grupos para observar seu efeito sobre a vari√°vel dependente. Exemplo: o pesquisador manipula o tipo de fertilizante que ser√° aplicado √†s plantas para observar como isso afeta seu crescimento.*

***Vari√°vel Dependente**: √â a vari√°vel que √© medida para observar o efeito das mudan√ßas na vari√°vel independente. Exemplo: o crescimento das plantas √© a vari√°vel que ser√° medida para observar o efeito dos diferentes tipos de fertilizantes.*

### Teste T com com vari√°veis independentes

Pacotes que ainda n√£o foram usados neste site e precisam ser instalados

```{r, echo=TRUE, eval=FALSE}
install.packages("rstatix")
install.packages("report")
install.packages("ggpubr")

```

```{r, message=FALSE, warning=FALSE}

library(ggplot2)
library(gsheet)
library(tidyverse)

dat_mg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137")

# Visualizando os dados com um gr√°fico de dispers√£o
dat_mg |> 
  ggplot(aes(trat, comp)) +
  geom_jitter(width = 0.1)
```

#### Realizando o Teste T

Agora, vamos realizar o Teste T para comparar os tratamentos. Primeiro, veremos os dados em formato largo e depois aplicaremos o teste para comparar os tratamentos control e Mg2.

```{r, message=FALSE, warning=FALSE}

dat_mg2 <- dat_mg |> 
  pivot_wider(names_from = trat, values_from = comp) |>  # Transformando os dados de "long" para "wide"
  dplyr::select(-rep)  # Removendo a coluna "rep"


head(dat_mg2)


```

#### Teste T para compara√ß√£o de m√©dias

Agora, aplicamos o Teste T para comparar as m√©dias dos tratamentos control e Mg2.

```{r, message=FALSE, warning=FALSE}

attach(dat_mg2)  # Facilitando o acesso √†s colunas dos dados
t_results <- t.test(control, Mg2)  # Comparando as duas condi√ß√µes
t_results

```

#### Explicando os resultados

```{r, message=FALSE, warning=FALSE}
library(report)

# Explicando os resultados do Teste T
report(t_results)
```

O pacote **`report`** gera uma explica√ß√£o detalhada sobre o resultado do teste, incluindo o valor p e as conclus√µes.

#### Realizando o Teste T no formato longo

Agora, vamos realizar o Teste T no formato longo dos dados, utilizando o pacote **`rstatix`**.

```{r, message=FALSE, warning=FALSE}
library(rstatix)

# Realizando o Teste T no formato longo
test <- t_test(comp ~ trat, data = dat_mg)
test

```

O `rstatix` √© um pacote para facilitar a realiza√ß√£o de an√°lises estat√≠sticas no R, com uma sintaxe simples e intuitiva. Ele oferece fun√ß√µes para realizar testes estat√≠sticos comuns (como t-test, ANOVA, correla√ß√£o), an√°lise de vari√¢ncia, testes de normalidade, entre outros, al√©m de simplificar a forma como os resultados s√£o apresentados.

#### Gr√°fico de Boxplot

Utilizando o pacote `ggpubr`, vamos criar um boxplot para visualizar as diferen√ßas entre os tratamentos control e Mg2, incluindo o valor p manualmente.

```{r, message=FALSE, warning=FALSE}
library(ggpubr)

# Criando o gr√°fico de boxplot
p <- ggboxplot(
  dat_mg, x = "trat", y = "comp",
  color = "trat", palette = "jco"
)
print(p)

# Adicionando o valor p manualmente no gr√°fico
p + stat_pvalue_manual(test, label = "p", y.position = 18) +
  ylim(0, 20) +
  labs(x = "Tratamento", y = "Comprimento (mm)")

# Salvando o gr√°fico como imagem
ggsave("plot2.png", bg = "white")


```

O pacote `ggpubr` fornece algumas fun√ß√µes f√°ceis de usar para criar e personalizar gr√°ficos prontos para publica√ß√£o baseados em `ggplot2.`

#### Testando a normalidade dos dados

Antes de realizar o Teste T, √© importante verificar a normalidade dos dados. Vamos usar o Teste de **Shapiro-Wilk** para testar se os dados seguem uma distribui√ß√£o normal.

```{r, message=FALSE, warning=FALSE}
library(rstatix)
# Realizando o teste de normalidade de Shapiro-Wilk para cada grupo
shapiro.test(Mg2)
shapiro.test(control)

# Criando histogramas para visualizar a distribui√ß√£o
hist(Mg2)
hist(control)

```

*O teste de **Shapiro-Wilk** √© um teste de hip√≥teses que avalia se um conjunto de dados √© normalmente distribu√≠do. Ele avalia dados de uma amostra com a hip√≥tese nula de que o conjunto de dados √© normalmente distribu√≠do. Um valor de p alto indica que o conjunto de dados √© normalmente distribu√≠do, enquanto um valor de p baixo indica que ele n√£o √© normalmente distribu√≠do.*

#### Teste de homogeneidade de vari√¢ncias

Por fim, vamos testar se as vari√¢ncias entre os dois grupos s√£o homog√™neas utilizando o **Teste F**.

```{r, message=FALSE, warning=FALSE}
var.test(dat_mg2$Mg2, dat_mg2$control)  # Teste de vari√¢ncias


```

*O **Teste F** √© utilizado principalmente para testar a igualdade de vari√¢ncias entre dois ou mais grupos. Ele √© uma ferramenta essencial em diversas an√°lises estat√≠sticas, especialmente antes de realizar testes como o Teste T, que exige que as vari√¢ncias dos grupos sejam homog√™neas (iguais).*

*Aten√ß√£o: caso as vari√¢ncias n√£o sejam homog√™neas, o par√¢metro `var.equal = FALSE` deve ser utilizado dentro do Teste T.*

### **Realizando o Teste T** com v√°riaveis dependentes

```{r}
 library(gsheet)

# Carregando os dados da planilha do Google
escala <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173")
```

Agora, vamos realizar o Teste T Pareado para comparar a acur√°cia entre as duas condi√ß√µes de avalia√ß√£o (Unaided e Aided1). Usaremos o par√¢metro `paired = TRUE` para indicar que as amostras s√£o pareadas, e `var.equal = FALSE` para n√£o assumir que as vari√¢ncias dos dois grupos s√£o iguais.

```{r, message=FALSE, warning=FALSE}
library(rstatix)
test <- t_test(acuracia ~ assessment,
       data = escala,
       paired = TRUE,
       var.equal = FALSE)
test
```

#### Visualizando a Distribui√ß√£o com Boxplot

A seguir, vamos visualizar a distribui√ß√£o das acur√°cias nas diferentes condi√ß√µes de avalia√ß√£o usando um gr√°fico de boxplot:

```{r, message=FALSE, warning=FALSE}
library(ggplot2)
escala |> 
  ggplot(aes(assessment, acuracia)) +
         geom_boxplot()

```

#### Filtrando os dados para cada condi√ß√£o

Vamos agora separar os dados para as duas condi√ß√µes de avalia√ß√£o: "Unaided" (sem aux√≠lio) e "Aided1" (com aux√≠lio). Em seguida, extra√≠mos os valores de acur√°cia para cada uma.

```{r, message=FALSE, warning=FALSE}

unaided <- escala |> 
  filter(assessment == "Unaided") |> 
  select(acuracia) |> 
  pull()
unaided


aided <- escala |> 
  filter(assessment == "Aided1") |> 
  select(acuracia) |> 
  pull()
aided
```

#### Testando a igualdade de vari√¢ncias

Antes de aplicar o Teste T, √© importante verificar se as vari√¢ncias entre os dois grupos s√£o iguais. Vamos usar o Teste F para testar essa hip√≥tese:

```{r, message=FALSE, warning=FALSE}
# Testando a igualdade de vari√¢ncias entre os dois grupos usando o teste F
var.test(unaided, aided)
```

#### Visualizando a distribui√ß√£o com histogramas

A seguir, vamos visualizar as distribui√ß√µes das acur√°cias para ambas as condi√ß√µes usando histogramas. Isso nos ajudar√° a entender a forma das distribui√ß√µes.

```{r, message=FALSE, warning=FALSE}
hist(unaided)  
hist(aided)    

```

#### Testando a normalidade dos dados

```{r, message=FALSE, warning=FALSE}
# Realizando o teste de normalidade de Shapiro-Wilk para cada grupo
shapiro.test(unaided)
shapiro.test(aided)

```

#### Aplicando o Teste T

Com os dados sendo normais e as vari√¢ncias sendo testadas, podemos aplicar o Teste T Pareado para comparar as duas condi√ß√µes.

```{r, message=FALSE, warning=FALSE}
# Realizando o teste t pareado para comparar as duas condi√ß√µes
# Este teste √© usado para dados com distribui√ß√£o normal e vari√¢ncias homog√™neas
t.test(unaided, aided, paired = TRUE, var.equal = FALSE)

```

#### Teste N√£o Param√©trico de Wilcoxon

Caso os dados n√£o atendam aos pressupostos do Teste T (como a normalidade), podemos usar o **Teste de Wilcoxon** como uma alternativa n√£o param√©trica.

```{r, message=FALSE, warning=FALSE}
wilcox.test(unaided, aided)

```

O *teste de postos com sinais de **Wilcoxon** √© um teste nao-param√©trico que usa os postos de dados amostrais compostos de pares combinados. √â usado pra testar diferen√ßas nas distribui√ß√µes populacionais, de modo que as hip√≥teses nula e alternativa s√£o:*

-   *Ho : as duas amostras prov√©m de popula√ß√µes com a mesma distribui√ß√£o.*

-   *H1: as duas amostras prov√©m de popula√ß√µes com distribui√ß√µes diferentes.*

#### Teste de Mann-Whitney para Grupos Independentes

Se quisermos comparar duas amostras independentes, podemos utilizar o **Teste de Mann-Whitney**. Aqui, as condi√ß√µes "Unaided" e "Aided1" s√£o tratadas como grupos independentes.

```{r, message=FALSE, warning=FALSE}
# Aqui, 'paired = FALSE' √© usado porque estamos comparando grupos independentes
wilcox.test(unaided, aided, paired = FALSE)

```

*O **Teste de Mann-Whitney** √© um teste estat√≠stico n√£o param√©trico usado para comparar as medianas de dois grupos independentes. Ele √© uma alternativa ao Teste T quando os dados n√£o seguem uma distribui√ß√£o normal.*
